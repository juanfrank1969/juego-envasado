<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego del Envasado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body { background-color: #f0fdf4; font-family: sans-serif; overflow: hidden; }
        .box-part { transition: all 0.4s ease; opacity: 0; transform: scale(0.8); }
        .box-part.visible { opacity: 1; transform: scale(1); }
        .cardboard { background-color: #d4a373; border: 2px solid #9c6644; position: absolute; }
    </style>
</head>
<body class="h-screen flex flex-col items-center justify-center p-4">

    <!-- Marcador -->
    <div class="mb-6 text-center">
        <h1 class="text-3xl font-bold text-green-800">üì¶ EL ENVASADO</h1>
        <p class="text-green-600 font-bold uppercase tracking-widest text-sm" id="level-tag">Nivel 1</p>
        <div class="mt-2 text-xl font-bold">Puntos: <span id="score">0</span></div>
    </div>

    <!-- Escena de la Caja -->
    <div class="relative w-64 h-64 bg-white rounded-3xl shadow-xl flex items-center justify-center overflow-hidden border-4 border-green-200">
        <div id="character" class="text-8xl z-10 transition-transform duration-300">üò∞</div>
        
        <!-- Partes de la caja (se activan al fallar) -->
        <div id="p1" class="box-part cardboard w-full bottom-0 h-1/6 z-0"></div>
        <div id="p2" class="box-part cardboard w-full h-full bottom-0 bg-[#ccb7a3] z-0"></div>
        <div id="p3" class="box-part cardboard h-full left-0 w-1/6 z-20"></div>
        <div id="p4" class="box-part cardboard h-full right-0 w-1/6 z-20"></div>
        <div id="p5" class="box-part cardboard w-full bottom-0 h-4/6 z-30 opacity-90"></div>
        <div id="p6" class="box-part cardboard w-full h-full top-0 z-40 flex items-center justify-center bg-[#8d5c3d]">
            <span class="text-white font-bold border-2 p-1 rounded">SELLADO</span>
        </div>
    </div>

    <!-- √Årea de Juego -->
    <div class="mt-8 w-full max-w-md text-center">
        <div id="cat" class="text-xs font-bold text-green-700 bg-green-100 inline-block px-3 py-1 rounded-full mb-4">CATEGOR√çA</div>
        <div id="word" class="flex justify-center gap-2 mb-8 text-3xl font-bold text-green-900 tracking-widest"></div>
        <div id="keyboard" class="grid grid-cols-7 gap-1"></div>
        
        <button id="next-btn" onclick="init()" class="hidden mt-6 bg-green-600 text-white px-8 py-3 rounded-full font-bold shadow-lg">SIGUIENTE PALABRA</button>
    </div>

    <script>
        const words = [
            {w: "CASA", c: "HOGAR"}, {w: "PERRO", c: "ANIMAL"}, {w: "SOL", c: "CIELO"},
            {w: "MANZANA", c: "FRUTA"}, {w: "MEXICO", c: "PAIS"}, {w: "PIANO", c: "MUSICA"},
            {w: "AVION", c: "TRANSPORTE"}, {w: "FUTBOL", c: "DEPORTE"}, {w: "QUESO", c: "COMIDA"},
            {w: "BIBLIOTECA", c: "LUGAR"}, {w: "ASTRONAUTA", c: "OFICIO"}, {w: "ELEFANTE", c: "ANIMAL"}
        ];

        let secret, letters, fails, score = 0, level = 1;

        function init() {
            const item = words[Math.floor(Math.random() * words.length)];
            secret = item.w;
            document.getElementById('cat').textContent = item.c;
            letters = [];
            fails = 0;
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('character').textContent = "üò∞";
            for(let i=1; i<=6; i++) document.getElementById('p'+i).classList.remove('visible');
            render();
            renderKeys();
        }

        function render() {
            const display = secret.split('').map(l => letters.includes(l) ? l : "_").join(" ");
            document.getElementById('word').textContent = display;
            if(!display.includes("_")) win();
        }

        function renderKeys() {
            const kb = document.getElementById('keyboard');
            kb.innerHTML = '';
            "ABCDEFGHIJKLMN√ëOPQRSTUVWXYZ".split('').forEach(l => {
                const btn = document.createElement('button');
                btn.textContent = l;
                btn.className = "bg-white p-2 rounded shadow font-bold text-green-700 disabled:opacity-30";
                btn.disabled = letters.includes(l) || fails >= 6;
                btn.onclick = () => {
                    letters.push(l);
                    if(!secret.includes(l)) {
                        fails++;
                        document.getElementById('p'+fails).classList.add('visible');
                        if(fails >= 6) lose();
                    }
                    render();
                    renderKeys();
                };
                kb.appendChild(btn);
            });
        }

        function win() {
            score += 100;
            document.getElementById('score').textContent = score;
            document.getElementById('character').textContent = "üòé";
            document.getElementById('next-btn').classList.remove('hidden');
            confetti();
        }

        function lose() {
            document.getElementById('character').textContent = "üì¶";
            document.getElementById('word').textContent = secret;
            document.getElementById('next-btn').classList.remove('hidden');
            document.getElementById('next-btn').textContent = "REINTENTAR";
        }

        init();
    </script>
</body>
</html>
